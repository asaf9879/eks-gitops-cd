name: Deploy via ArgoCD

on:
  push:
    branches: [main]
    paths:
      - 'helm/**'
      - 'environments/**'

permissions:
  contents: read

jobs:
  notify-argocd:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      # אופציונלי: אם ArgoCD שלך לא על auto-sync – הפעל סנכרון ידני:
      # ודא שיש לך את הסודות הבאים:
      # ARGOCD_SERVER, ARGOCD_USERNAME, ARGOCD_PASSWORD

      # - name: Install ArgoCD CLI
      #   run: |
      #     curl -sSL -o /usr/local/bin/argocd https://github.com/argoproj/argo-cd/releases/latest/download/argocd-linux-amd64
      #     chmod +x /usr/local/bin/argocd

      # - name: Login to ArgoCD
      #   run: |
      #     argocd login ${{ secrets.ARGOCD_SERVER }} \
      #       --username ${{ secrets.ARGOCD_USERNAME }} \
      #       --password ${{ secrets.ARGOCD_PASSWORD }} \
      #       --insecure

      # - name: Sync Application
      #   run: |
      #     argocd app sync flask-app

      - name: Done
        run: echo "Config changes pushed. If ArgoCD auto-sync is enabled, app will be updated."

